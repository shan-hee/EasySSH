## 系统监控功能

EasySSH 提供了基于SSH的系统监控功能，可以实时查看远程服务器的系统状态。

### 支持的监控指标

- **CPU使用率**：实时显示CPU使用率百分比
- **内存使用情况**：显示系统内存使用量、总量和使用率百分比
- **交换分区**：显示交换分区使用情况和百分比
- **磁盘使用情况**：显示主分区的使用情况、总量和可用空间
- **网络状态**：显示实时流量传输统计
- **系统信息**：显示操作系统类型、版本、主机名和架构
- **IP地址信息**：显示内网IP和公网IP地址

### 监控工作模式

EasySSH 系统监控采用基于SSH的零安装监控模式：

1. **SSH集成**：基于现有SSH连接，无需安装额外组件
2. **命令收集**：通过SSH执行系统命令获取监控数据
3. **数据传输**：通过专用WebSocket通道传输监控数据
4. **实时更新**：每秒自动更新一次系统数据（可配置间隔）
5. **智能缓存**：IP地址等静态信息采用智能缓存策略
6. **自动启停**：SSH连接建立/断开时自动启动/停止监控
7. **性能优化**：并行数据收集、批量传输、错误重试机制

这种设计具有以下优势：
- **零安装**：无需在服务器上安装任何额外组件
- **安全可靠**：基于现有SSH安全通道
- **轻量级**：通过系统命令收集数据，资源占用极少
- **即开即用**：SSH连接后立即可用监控功能
- **高性能**：优化的数据收集和传输机制
- **容错性强**：具备完善的错误处理和重试机制

### 使用方法

1. **建立SSH连接**：在EasySSH中连接到远程服务器
2. **自动启动监控**：SSH连接成功后，监控数据收集自动开始
3. **查看监控数据**：在工具栏中查看实时系统监控信息
4. **监控面板**：点击监控按钮可查看详细的系统监控面板

### 技术原理

- **数据收集**：通过SSH执行系统命令（如free、df、cat /proc/*等）获取监控数据
- **数据传输**：通过专用WebSocket通道（/monitor）传输监控数据
- **实时更新**：默认每秒更新一次监控数据，支持动态调整间隔（0.5-10秒）
- **智能缓存**：静态信息（如CPU型号）和IP地址采用智能缓存策略
- **安全传输**：基于现有SSH安全通道，无需额外认证
- **性能优化**：并行数据收集、批量传输、错误重试等优化机制
- **容错处理**：完善的错误处理和连接恢复机制

### 监控数据流（Mermaid）

```mermaid
flowchart TB
    subgraph Frontend[前端]
      FE[浏览器 UI]
    end

    subgraph Server[后端（Express + ws）]
      MON_WS[监控 WS (/monitor)]
      MON_CLI_WS[监控客户端 WS (/monitor-client)]
      BRIDGE[监控桥接服务]
      CACHE[(监控数据缓存)]
    end

    subgraph Collectors[数据采集]
      SSHC[SSH 收集器\n(复用现有 SSH 会话)]
      EXT[外部监控客户端\n(可选)]
    end

    FE <--> MON_WS
    SSHC --> BRIDGE
    EXT <--> MON_CLI_WS
    MON_CLI_WS --> BRIDGE
    BRIDGE <--> CACHE
    BRIDGE --> MON_WS
```

说明：
- 默认模式下，后端通过已建立的 SSH 会话执行系统命令，BRIDGE 汇聚并推送数据到前端的 `/monitor` 订阅。
- 如启用外部监控客户端，则客户端通过 `/monitor-client` 推送数据，同样经 BRIDGE 转发给前端并写入缓存。

### 监控数据说明

监控服务收集的数据包括：

- **系统基础信息**：主机名、操作系统、架构等
- **资源使用情况**：CPU、内存、磁盘、网络等实时数据
- **网络信息**：内网IP、公网IP地址
- **时间戳**：数据收集时间，用于数据同步

所有数据通过SSH安全通道传输，确保数据安全性。
